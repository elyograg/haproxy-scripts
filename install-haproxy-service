#!/bin/bash

SCRIPT_DIR="$(cd "$(dirname "$0")" || exit ; pwd -P)"
# shellcheck source=./common-functions.sh
source "${SCRIPT_DIR}/common-functions.sh"

DIR=$(dirname "$0")/"$1"/admin/systemd
if [ -e "$DIR" ]; then
  if [ -d "$DIR" ]; then
    cd "${DIR}" || exit
    sudo -E make clean haproxy.service
    sudo -E cp haproxy.service /etc/systemd/system/.
    sudo -E systemctl daemon-reload
    sudo -E systemctl enable haproxy
  else
    log_err "location ($DIR) is not a directory."
  fi
else
  log_err "location ($DIR) does not exist."
fi
